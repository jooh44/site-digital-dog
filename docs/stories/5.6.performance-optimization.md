# Story 5.6: Performance Optimization

**Epic:** 5 - Homepage Advanced  
**Status:** Draft  
**Sprint:** 5 (Semanas 9-10)  
**Prioridade:** ðŸŸ¡ Alta

---

## Story

**As a** website visitor,  
**I want** the website to load quickly and perform well,  
**so that** I have a smooth browsing experience.

---

## Acceptance Criteria

1. Code splitting implemented
2. Font optimization completed
3. Lazy load heavy components
4. PageSpeed Mobile >85, Desktop >90
5. Core Web Vitals meet requirements (LCP <2.5s, FCP <1.8s, CLS <0.1)

---

## Tasks / Subtasks

- [ ] Task 1: Implement Code Splitting (AC: 1)
  - [ ] Use dynamic imports for heavy components
  - [ ] Split routes automatically (Next.js)
  - [ ] Optimize bundle size

- [ ] Task 2: Optimize Fonts (AC: 2)
  - [ ] Use Next.js font optimization
  - [ ] Configure display: swap
  - [ ] Preload critical fonts
  - [ ] Verify fonts load efficiently

- [ ] Task 3: Lazy Load Heavy Components (AC: 3)
  - [ ] Identify heavy components (Calendly, animations, etc.)
  - [ ] Use dynamic imports with ssr: false
  - [ ] Add loading states

- [ ] Task 4: Run Performance Audit (AC: 4, 5)
  - [ ] Run Lighthouse audit
  - [ ] Check PageSpeed scores
  - [ ] Check Core Web Vitals
  - [ ] Identify optimization opportunities

- [ ] Task 5: Apply Optimizations (AC: 4, 5)
  - [ ] Fix identified issues
  - [ ] Optimize JavaScript bundles
  - [ ] Optimize CSS
  - [ ] Verify improvements

---

## Dev Notes

### Previous Story Insights
[From Story 5.5]
- Images optimized
- Next.js Image component used

### Code Splitting
[Source: architecture/performance-optimization.md - Section 9]

Dynamic imports:
```tsx
import dynamic from 'next/dynamic';

const CalendlyEmbed = dynamic(() => import('@/components/forms/CalendlyEmbed'), {
  ssr: false,
  loading: () => <div>Carregando agendamento...</div>
});
```

### Font Optimization
[Source: architecture/performance-optimization.md - Section 9]

Next.js font optimization:
```tsx
import { Space_Grotesk, Inter } from 'next/font/google';

const spaceGrotesk = Space_Grotesk({
  subsets: ['latin'],
  variable: '--font-heading',
  display: 'swap',
  preload: true,
});
```

### Performance Requirements
[Source: prd/requisitos-nao-funcionais.md]

- PageSpeed Mobile â‰¥85
- PageSpeed Desktop â‰¥90
- LCP <2.5s
- FCP <1.8s
- CLS <0.1

### File Locations
[Source: architecture/source-tree.md]

- Components: Various
- Layout: `app/layout.tsx`

### Testing
[Source: architecture/testing-strategy.md]

**Testing Standards:**
- Run Lighthouse audit
- Check PageSpeed scores
- Check Core Web Vitals
- For this story: Lighthouse + PageSpeed Insights

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-11-17 | 1.0 | Initial story creation | SM (Bob) |

---

## Dev Agent Record

### Agent Model Used
_To be filled by Dev Agent_

### Debug Log References
_To be filled by Dev Agent_

### Completion Notes List
_To be filled by Dev Agent_

### File List
_To be filled by Dev Agent_

---

## QA Results
_To be filled by QA Agent_

---

