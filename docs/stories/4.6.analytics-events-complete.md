# Story 4.6: Analytics Events Complete

**Epic:** 4 - Conversion Flow  
**Status:** Draft  
**Sprint:** 4 (Semanas 7-8)  
**Prioridade:** ðŸ”´ CrÃ­tica

---

## Story

**As a** product owner,  
**I want** all conversion events tracked in GA4 and Meta Pixel,  
**so that** I can measure the full conversion funnel and optimize performance.

---

## Acceptance Criteria

1. GA4 events implemented: form_submit, calendly_booking, conversion
2. Meta Pixel events implemented: Lead, Schedule, CompleteRegistration
3. All events fire at correct moments
4. Events include relevant parameters
5. Tracking tested and verified in both platforms

---

## Tasks / Subtasks

- [ ] Task 1: Implement Form Submit Tracking (AC: 1, 2)
  - [ ] Track GA4: `form_submit` on form submission
  - [ ] Track Meta Pixel: `Lead` on form submission
  - [ ] Add event parameters (form_name, etc.)

- [ ] Task 2: Implement Calendly Booking Tracking (AC: 1, 2)
  - [ ] Track GA4: `calendly_booking` on booking completion
  - [ ] Track Meta Pixel: `Schedule` on booking completion
  - [ ] Listen for Calendly events

- [ ] Task 3: Implement Conversion Tracking (AC: 1, 2)
  - [ ] Track GA4: `conversion` on thank you page
  - [ ] Track Meta Pixel: `CompleteRegistration` on thank you page
  - [ ] Fire on page load

- [ ] Task 4: Update Analytics Helper (AC: 4)
  - [ ] Add helper functions for all events
  - [ ] Add event parameters support
  - [ ] Ensure type safety

- [ ] Task 5: Test All Events (AC: 3, 5)
  - [ ] Test in GA4 real-time reports
  - [ ] Test in Meta Pixel Events Manager
  - [ ] Verify all events fire correctly
  - [ ] Verify event parameters

---

## Dev Notes

### Previous Story Insights
[From Story 2.6]
- GA4 and Meta Pixel configured
- Analytics helper created
[From Story 4.1-4.5]
- Form, Calendly, API, thank you page implemented

### Analytics Events
[Source: architecture/external-integrations.md - Section 7]

**GA4 Events:**
- `form_submit` - Form submission
- `calendly_booking` - Calendly booking completed
- `conversion` - Thank you page (conversion)

**Meta Pixel Events:**
- `Lead` - Form submission
- `Schedule` - Calendly booking
- `CompleteRegistration` - Thank you page

### Event Parameters
[Source: prd/requisitos-nao-funcionais.md]

Events should include relevant parameters:
- Form name
- Page URL
- Timestamp
- User properties (if available)

### File Locations
[Source: architecture/source-tree.md]

- Analytics helper: `lib/analytics.ts`
- Form component: `components/forms/DiagnosticoForm.tsx`
- Calendly component: `components/forms/CalendlyEmbed.tsx`
- Thank you page: `app/obrigado/page.tsx`

### Testing
[Source: architecture/testing-strategy.md]

**Testing Standards:**
- Test all events in GA4 real-time
- Test all events in Meta Pixel Events Manager
- Verify event parameters
- For this story: Manual testing sufficient

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-11-17 | 1.0 | Initial story creation | SM (Bob) |

---

## Dev Agent Record

### Agent Model Used
_To be filled by Dev Agent_

### Debug Log References
_To be filled by Dev Agent_

### Completion Notes List
_To be filled by Dev Agent_

### File List
_To be filled by Dev Agent_

---

## QA Results
_To be filled by QA Agent_

---

